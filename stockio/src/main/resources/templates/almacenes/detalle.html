<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title th:text="'Categorías del Almacén: ' + ${almacen.nombre}">Categorías del Almacén</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .btn {
            padding: 5px 10px;
            text-decoration: none;
            border: 1px solid #ccc;
            background: #eee;
            color: black;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
            border: none;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
            border: none;
        }

        .actions {
            white-space: nowrap;
        }
    </style>
</head>

<body>

    <h1 th:text="'Categorías del Almacén: ' + ${almacen.nombre}">Categorías del Almacén</h1>
    <h4 style="color: gray; margin-top: -15px;" th:text="${almacen.ubicacion}">Ubicación</h4>

    <!-- Botonera superior like index.html -->
    <a th:href="@{/categorias/nueva(almacenId=${almacen.id})}" class="btn btn-primary"
        sec:authorize="hasAnyRole('ADMIN', 'JEFE_ALMACEN')">Nueva Categoría</a>
    <a href="/almacenes" class="btn">Volver a Almacenes</a>

    <!-- Lista de Inventario Agrupada -->
    <div th:if="${esVacio}" style="text-align: center; margin-top: 50px;">
        <p>Este almacén no tiene categorías registradas aún.</p>
        <p>¡Crea la primera categoría para empezar!</p>
    </div>

    <!-- Tabla Resumen de Categorías -->
    <table th:unless="${esVacio}">
        <thead>
            <tr>
                <th>Nombre de Categoría</th>
                <th>Producto Diferentes</th>
                <th>Total Productos (unidades)</th>
                <th>Valor Total Stock</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="cat : ${categorias}">
                <td th:text="${cat.nombre}"></td>
                <td>-</td>
                <!-- Placeholder for 'number of distinct products' if available, otherwise just remove or put - -->
                <td th:text="${cat.cantidad}"></td>
                <td th:text="${#numbers.formatDecimal(cat.valor, 1, 2) + ' €'}"></td>
                <td class="actions">
                    <!-- Botón Entrar: Redirige a la vista detallada de esa categoría -->
                    <a th:href="@{/almacenes/{id}/categoria(id=${almacen.id}, nombre=${cat.nombre})}"
                        class="btn btn-primary" style="margin-right: 5px;">Entrar</a>
                    <!-- Placeholder buttons acting as if they exist, for UI consistency -->
                    <a th:href="@{/categorias/editar/{id}(id=${cat.id}, almacenId=${almacen.id})}" class="btn"
                        sec:authorize="hasAnyRole('ADMIN', 'JEFE_ALMACEN')">Editar</a>
                    <a th:href="@{/categorias/eliminar/{id}(id=${cat.id}, almacenId=${almacen.id})}"
                        class="btn btn-danger" onclick="return confirm('¿Estás seguro de eliminar esta categoría?');"
                        sec:authorize="hasAnyRole('ADMIN', 'JEFE_ALMACEN')">Eliminar</a>
                </td>
            </tr>
        </tbody>
    </table>

</body>

</html>